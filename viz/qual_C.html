<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <title>Qual C — Topic Browser</title>
  <script src="https://d3js.org/d3.v7.min.js"></script>
  <style>
    body { font-family: system-ui, Arial, sans-serif; margin: 24px; }
    .container { max-width: 1000px; margin: auto; display: grid; grid-template-columns: 1fr 1fr; grid-gap: 24px; }
    .panel { border: 1px solid #eee; padding: 12px; border-radius: 8px; }
    #uploader { grid-column: span 2; }
    ul { margin: 0; padding-left: 20px; }
    .topic { cursor: pointer; margin-bottom: 6px; }
  </style>
</head>
<body>
<div class="container">
  <div id="uploader" class="panel">
    <h2>Qual Option C — Topic Browser</h2>
    <p>Upload <code>qual_C_topics.json</code> with structure:</p>
<pre>{
  "topics": [ {"topic":0,"top_terms":["term1","term2",...]}, ... ],
  "samples": [ {"topic":0,"doc_ids":[...]}, ... ]
}</pre>
    <input type="file" id="file" accept=".json" />
  </div>
  <div class="panel">
    <h3>Topics</h3>
    <div id="topics"></div>
  </div>
  <div class="panel">
    <h3>Details</h3>
    <div id="details"><em>Select a topic</em></div>
  </div>
</div>
<script>
let data=null;
document.getElementById('file').addEventListener('change', async (ev) => {
  data = JSON.parse(await ev.target.files[0].text()); renderList();
});
function renderList(){
  const div = d3.select('#topics').html('');
  (data.topics||[]).forEach(t => {
    div.append('div').attr('class','topic')
      .text(`Topic ${t.topic}: ${t.top_terms.slice(0,6).join(', ')}`)
      .on('click', () => showDetails(t.topic));
  });
}
function showDetails(topicId){
  const t = (data.topics||[]).find(x => x.topic==topicId);
  const s = (data.samples||[]).find(x => x.topic==topicId);
  const d = d3.select('#details').html('');
  d.append('h4').text(`Topic ${topicId}`);
  d.append('p').html('<b>Top terms:</b> ' + (t?.top_terms||[]).join(', '));
  d.append('p').html('<b>Sample doc_ids:</b> ' + (s?.doc_ids||[]).join(', '));
}
</script>
</body>
</html>
